(this["webpackJsonprail-map-generator"]=this["webpackJsonprail-map-generator"]||[]).push([[50],[function(e,t){e.exports=React},,function(e,t){e.exports=MaterialUI},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i}));var a=n(3),r=n(1),c=n(0),l=Object(c.createContext)({}),s=Object(c.createContext)({}),i=function(e,t){var n,c,l,s,i,o;switch(t.type){case"GLOBAL":return t.data;case"ANY":return Object(r.a)({},e,Object(a.a)({},t.key,t.data));case"SET_HEIGHT":return Object(r.a)({},e,{svg_height:t.value});case"SET_WIDTH":return Object(r.a)({},e,{svgWidth:Object(r.a)({},e.svgWidth,Object(a.a)({},t.targetId,t.value))});case"SET_Y":return Object(r.a)({},e,{y_pc:t.value});case"SET_BRANCH_SPACING":return Object(r.a)({},e,{branch_spacing:t.value});case"SET_PADDING":return Object(r.a)({},e,{padding:t.value});case"SET_DIRECTION_GZ_X":return Object(r.a)({},e,{direction_gz_x:t.value});case"SET_DIRECTION_GZ_Y":return Object(r.a)({},e,{direction_gz_y:t.value});case"SET_LINE_NAME":return Object(r.a)({},e,{line_name:t.name});case"SET_THEME":return Object(r.a)({},e,{theme:t.theme});case"SET_DIRECTION":return Object(r.a)({},e,{direction:"l"===e.direction?"r":"l"});case"SET_PLATFORM":return Object(r.a)({},e,{platform_num:t.platform});case"SET_TEXT_FLIP":return Object(r.a)({},e,{txt_flip:!e.txt_flip});case"SET_DEST_LEGACY":return Object(r.a)({},e,{dest_legacy:t.isLegacy,customiseMTRDest:Object(r.a)({},e.customiseMTRDest,{isLegacy:t.isLegacy})});case"SET_TERMINAL_OVERRIDE":return Object(r.a)({},e,{customiseMTRDest:Object(r.a)({},e.customiseMTRDest,{terminal:t.terminal})});case"SET_LINE_NUM":return Object(r.a)({},e,{line_num:t.num});case"SET_PSD_NUM":return Object(r.a)({},e,{psd_num:t.num});case"SET_PANEL_TYPE":return Object(r.a)({},e,{info_panel_type:t.variant});case"ADD_NOTE_GZMTR":return Object(r.a)({},e,{notesGZMTR:null===(n=e.notesGZMTR)||void 0===n?void 0:n.concat([["","",0,0,!1]])});case"REMOVE_NOTE_GZMTR":return Object(r.a)({},e,{notesGZMTR:null===(c=e.notesGZMTR)||void 0===c?void 0:c.filter((function(e,n){return n!==t.idx}))});case"UPDATE_NOTE_GZMTR":return Object(r.a)({},e,{notesGZMTR:null===(l=e.notesGZMTR)||void 0===l?void 0:l.map((function(e,n){return n===t.idx?t.note:e}))});case"UPDATE_STATION_NAME":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{name:t.name})))});case"UPDATE_STATION_NUM":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{num:t.num})))});case"UPDATE_STATION_TRANSFER":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{transfer:t.transfer})))});case"UPDATE_STATION_INTERCHANGE_INFO":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{transfer:Object(r.a)({},e.stn_list[t.stnId].transfer,{info:null===(s=e.stn_list[t.stnId].transfer)||void 0===s?void 0:s.info.map((function(e,n){return n===t.setIdx?e.map((function(e,n){return n===t.intIdx?[0,1,2,3,4,5].map((function(n){return void 0===t.info[n]?e[n]:t.info[n]})):e})):e}))})})))});case"UPDATE_STATION_OSI_NAME":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{transfer:Object(r.a)({},e.stn_list[t.stnId].transfer,{osi_names:[t.name]})})))});case"UPDATE_STATION_TICK_DIREC":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{transfer:Object(r.a)({},e.stn_list[t.stnId].transfer,{tick_direc:t.direction})})))});case"UPDATE_STATION_PAID_AREA":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{transfer:Object(r.a)({},e.stn_list[t.stnId].transfer,{paid_area:t.isPaid})})))});case"UPDATE_STATION_BRANCH_TYPE":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{branch:Object(r.a)({},e.stn_list[t.stnId].branch,Object(a.a)({},t.direction,[t.branchType,e.stn_list[t.stnId].branch[t.direction][1]]))})))});case"UPDATE_STATION_BRANCH_FIRST":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,(i={},Object(a.a)(i,t.branches[0].stnId,Object(r.a)({},e.stn_list[t.branches[0].stnId],{branch:Object(r.a)({},e.stn_list[t.branches[0].stnId].branch,Object(a.a)({},t.branches[0].direction,[e.stn_list[t.branches[0].stnId].branch[t.branches[0].direction][0],t.branches[0].first]))})),Object(a.a)(i,t.branches[1].stnId,Object(r.a)({},e.stn_list[t.branches[1].stnId],{branch:Object(r.a)({},e.stn_list[t.branches[1].stnId].branch,Object(a.a)({},t.branches[1].direction,[e.stn_list[t.branches[1].stnId].branch[t.branches[1].direction][0],t.branches[1].first]))})),i))});case"UPDATE_STATION_BRANCH_POS":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,(o={},Object(a.a)(o,t.left,Object(r.a)({},e.stn_list[t.left],{parents:e.stn_list[t.left].parents.slice().reverse()})),Object(a.a)(o,t.right,Object(r.a)({},e.stn_list[t.right],{children:e.stn_list[t.right].children.slice().reverse()})),o))});case"UPDATE_STATION_FACILITY":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{facility:t.facility})))});case"UPDATE_STATION_SERVICES":return Object(r.a)({},e,{stn_list:Object(r.a)({},e.stn_list,Object(a.a)({},t.stnId,Object(r.a)({},e.stn_list[t.stnId],{services:Array.from(t.isChecked?new Set(e.stn_list[t.stnId].services).add(t.serviceId):e.stn_list[t.stnId].services.filter((function(e){return e!==t.serviceId})))})))});case"UPDATE_STATION_LIST":return Object(r.a)({},e,{stn_list:t.stnList});default:return e}}},,,,function(e,t){e.exports=ReactI18next},,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o}));var a=n(4),r=n(0),c=n.n(r),l=function e(t,n){if(["linestart","lineend"].includes(t)||n[t].parents.length>1||n[t].children.length>1)return 0;var a=n[t].parents[0];return a?1===n[a].children.length?e(a,n):0===n[a].children.indexOf(t)?1:-1:0},s=function(e){console.log("computing branches");for(var t=["linestart"],n=[["linestart"]],a=0;t.length;){var r=t.shift(),c=n[a].slice().reverse()[0]||null;for(c&&"linestart"!==r?n[a].push(r):n[a]=[r];"lineend"!==r;){var l=e[c=r].children;if(function(){switch(l.length){case 1:r=l[0];break;case 2:var s=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push([r]),t.push(s)):0===a&&(n.push([c]),t.push(s)),r=l.filter((function(e){return e!==s}))[0]}}(),n[a].push(r),c===e[r].branch.left[1])break}a++}return n},i=function(e){console.log("computing routes");for(var t=["linestart"],n=[["linestart"]],a=0;t.length;){var r=t.shift(),c=n[a].slice().reverse()[0]||null;for(c&&"linestart"!==r?n[a].push(r):n[a]=[r];"lineend"!==r;){var l=e[c=r].children;if(function(){switch(l.length){case 1:r=l[0];break;case 2:var s=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push(n[a].slice()),t.push(s)):0===a&&(n.push([c]),t.push(s)),r=l.filter((function(e){return e!==s}))[0]}}(),n[a].push(r),c===e[r].branch.left[1]&&"nonthrough"===e[r].branch.left[0])break}a++}return n},o=function(e){var t=c.a.useState([]),n=Object(a.a)(t,2),r=n[0],l=n[1];return c.a.useEffect((function(){if(console.log("computing tpo"),1!==e.length){var t=e.reduce((function(e,t){var n=e.indexOf(t.slice(-1)[0]);return e.slice(0,n).concat(t.slice(1),e.slice(n+1))}),["lineend"]).slice(0,-1);l(t)}else l(e[0].slice(1,-1))}),[e.toString()]),r}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var a=n(4);function r(){var e,t=JSON.parse(localStorage.rmgParam);"line_name"in t||(t.line_name=["\u8def\u7dda\u540d","Name of Line"]),"dest_legacy"in t||(t.dest_legacy=!1),delete t.fontZH,delete t.fontEN,delete t.weightZH,delete t.weightEN;for(var n=0,r=Object.entries(t.stn_list);n<r.length;n++){var c=Object(a.a)(r[n],2),l=c[0],s=c[1];"branch"in s||(t.stn_list[l].branch={left:[],right:[]},2===s.children.length?t.stn_list[l].branch.right=["through",s.children[1]]:t.stn_list[l].branch.right=[],2===s.parents.length?t.stn_list[l].branch.left=["through",s.parents[1]]:t.stn_list[l].branch.left=[])}"psd_num"in t||(t.psd_num=1),"line_num"in t||(t.line_num=1),delete t.style,3===t.theme.length&&t.theme.push("#fff");for(var i=0,o=Object.entries(t.stn_list);i<o.length;i++){var u=Object(a.a)(o[i],2),m=u[0],h=u[1];["linestart","lineend"].includes(m)||("num"in h||(t.stn_list[m].num="00"))}for(var d=0,f=Object.values(t.stn_list);d<f.length;d++){var b=f[d];"interchange"in b&&b.interchange.map((function(e){return e.forEach((function(e){5===e.length&&e.splice(3,0,"#fff")}))}))}"info_panel_type"in t||(t.info_panel_type="panasonic");for(var g=0,_=Object.entries(t.stn_list);g<_.length;g++){var p=Object(a.a)(_[g],2),v=p[0],O=p[1];"osi22_end_p"===O.change_type&&(t.stn_list[v].change_type="osi22_pr"),"osi22_end_u"===O.change_type&&(t.stn_list[v].change_type="osi22_ur")}for(var E=0,j=Object.entries(t.stn_list);E<j.length;E++){var y=Object(a.a)(j[E],2),T=y[0];"interchange"in y[1]||(t.stn_list[T].interchange=[[]])}"gz_1"===t.info_panel_type&&(t.info_panel_type="gz28"),"panasonic"===t.info_panel_type&&(t.info_panel_type="gz28"),"gz_2"===t.info_panel_type&&(t.info_panel_type="gzgf"),"gz_3"===t.info_panel_type&&(t.info_panel_type="gz3"),"direction_gz_x"in t||(t.direction_gz_x=50),"direction_gz_y"in t||(t.direction_gz_y=70);for(var I=0,S=Object.entries(t.stn_list);I<S.length;I++){var x,N,A,w,P,k=Object(a.a)(S[I],2),C=k[0],M=k[1];if(!("transfer"in M))t.stn_list[C].transfer={type:null===(x=M.change_type)||void 0===x?void 0:x.split("_")[0],tick_direc:"none"===M.change_type||"int2"===M.change_type?"r":null===(N=M.change_type)||void 0===N?void 0:N.split("_")[1].split("").slice().reverse()[0],paid_area:-1===(null===(A=M.change_type)||void 0===A?void 0:A.indexOf("osi"))||"p"===(null===(w=M.change_type)||void 0===w?void 0:w.split("_")[1][0]),osi_names:-1!==(null===(P=M.change_type)||void 0===P?void 0:P.indexOf("osi"))?[M.interchange[1][0]]:[],info:2===M.interchange.length?[M.interchange[0],M.interchange[1].slice(1)]:M.interchange}}for(var D=0,R=Object.entries(t.stn_list);D<R.length;D++){var z=Object(a.a)(R[D],2),B=z[0];"services"in z[1]||(t.stn_list[B].services=["local"])}for(var L=0,G=Object.entries(t.stn_list);L<G.length;L++){var U=Object(a.a)(G[L],2),H=U[0];"usage"in U[1]||(t.stn_list[H].usage="")}for(var Z=0,F=Object.entries(t.stn_list);Z<F.length;Z++){var W=Object(a.a)(F[Z],2),J=W[0],Y=W[1];"facility"in Y||(t.stn_list[J].facility=Y.usage)}"customiseMTRDest"in t||(t.customiseMTRDest={isLegacy:t.dest_legacy||!1,terminal:!1}),"svgWidth"in t||(t.svgWidth={destination:t.svg_dest_width,runin:t.svg_dest_width,railmap:t.svg_width}),"notesGZMTR"in t||(t.notesGZMTR=[]),t.notesGZMTR=null===(e=t.notesGZMTR)||void 0===e?void 0:e.map((function(e){return 4===e.length?e.concat([!1]):e})),localStorage.setItem("rmgParam",JSON.stringify(t))}var c=function(e,t){var n=!0,a=!1,r=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var s=c.value;if(e[s])return e[s]}}catch(i){a=!0,r=i}finally{try{n||null==l.return||l.return()}finally{if(a)throw r}}return e.en},l=function(e,t){return"".concat("gzmtr"===t?((null===e||void 0===e?void 0:e.num)||"-")+": ":"").concat(null===e||void 0===e?void 0:e.name.join().replace("\\"," "))}},,,function(e,t){e.exports=i18next},,,,,,,,,function(e,t){e.exports=ReactDOM},function(e,t){e.exports=i18nextXHRBackend},function(e,t){e.exports=i18nextBrowserLanguageDetector},,,function(e,t,n){e.exports=n(40)},function(e,t,n){},,,,,,function(e,t,n){"use strict";n.r(t);var a=n(11),r=n(0),c=n.n(r),l=n(28),s=(n(34),n(19)),i=n.n(s),o=n(10),u=n(29),m=n.n(u),h=n(30),d=n.n(h);i.a.use(m.a).use(d.a).use(o.initReactI18next).init({fallbackLng:{"zh-CN":["zh-Hans","en"],"zh-Hant":["zh-HK","en"],"zh-HK":["zh-Hant","en"],"zh-TW":["zh-HK","zh-Hant"],default:["en"]},backend:{loadPath:"/rmg-test-page/locale/{{lng}}.json"},interpolation:{escapeValue:!1}}).then((function(e){document.title=e("title"),document.documentElement.setAttribute("lang",i.a.language)}));var f=n(4),b=n(18),g=n(2),_=n(6),p=Object(g.makeStyles)((function(e){return Object(g.createStyles)({rootLight:{backgroundColor:e.palette.primary.main},rootDark:{backgroundColor:e.palette.background.paper},title:{flexGrow:1,color:"#fff"},menuButton:{color:"#fff"}})})),v=function(){var e=Object(o.useTranslation)(),t=e.t,n=e.i18n,a=p(),c=Object(g.useMediaQuery)("(prefers-color-scheme: dark)");return r.useMemo((function(){return r.createElement(g.AppBar,{position:"sticky",className:c?a.rootDark:a.rootLight},r.createElement(g.Toolbar,{variant:"dense"},r.createElement(g.Typography,{variant:"h6",className:a.title,color:"textPrimary"},t("title")),r.createElement(O,null),r.createElement(E,null)))}),[c,n.language])},O=function(){var e=Object(o.useTranslation)().t,t=p(),n=r.useContext(_.a),a=n.canvasAvailable,c=n.setCanvasToShown,l=r.useState(null),s=Object(f.a)(l,2),i=s[0],u=s[1],m=function(e){return function(){c(e),u(null)}};return r.useMemo((function(){return r.createElement(r.Fragment,null,r.createElement(g.Tooltip,{title:e("toggle.tooltip")},r.createElement(g.IconButton,{onClick:function(e){return u(e.currentTarget)},className:t.menuButton},r.createElement(g.Icon,null,"photo_library"))),r.createElement(g.Menu,{anchorEl:i,open:Boolean(i),onClose:function(){return u(null)}},a.map((function(t){return r.createElement(g.MenuItem,{key:t,onClick:m(t)},e("toggle."+t))})),r.createElement(g.Divider,{style:{margin:"6px 0"}}),r.createElement(g.MenuItem,{onClick:m("all")},e("toggle.all"))))}),[a.toString(),i,t.menuButton])},E=function(){var e=Object(o.useTranslation)().t,t=p(),n=r.useContext(_.a).setCanvasScale;return r.useMemo((function(){return r.createElement(r.Fragment,null,r.createElement(g.Tooltip,{title:e("zoom.out")},r.createElement(g.IconButton,{onClick:function(){return n((function(e){return e<=.1?e:e-.1}))},className:t.menuButton},r.createElement(g.Icon,null,"zoom_out"))),r.createElement(g.Tooltip,{title:e("zoom.in")},r.createElement(g.IconButton,{onClick:function(){return n((function(e){return e+.1}))},className:t.menuButton},r.createElement(g.Icon,null,"zoom_in"))))}),[t.menuButton])},j=n(3),y=n(12),T=n(22),I=n(23),S=n(26),x=n(24),N=n(27),A=function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(S.a)(this,Object(x.a)(t).call(this,e))).state={hasError:!1},n}return Object(N.a)(t,e),Object(I.a)(t,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?c.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(c.a.Component),w=c.a.lazy((function(){return n.e(48).then(n.bind(null,101))})),P=c.a.lazy((function(){return n.e(66).then(n.bind(null,114))})),k=c.a.memo((function(e){var t=Object(r.useContext)(_.a),n=t.canvasAvailable,l=t.canvasToShown;return["share"].concat(Object(a.a)(n)).forEach((function(e){return document.getElementById("css_"+e).href="/rmg-test-page"+"/styles/".concat(e,"_mtr.css")})),c.a.createElement(c.a.Fragment,null,["destination","all"].includes(l)&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.CircularProgress,null)},c.a.createElement(A,null,c.a.createElement("svg",e.svgProps("destination"),e.children,c.a.createElement(w,null)))),["railmap","all"].includes(l)&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.CircularProgress,null)},c.a.createElement(A,null,c.a.createElement("svg",e.svgProps("railmap"),e.children,c.a.createElement(P,null)))))}),(function(){return!0})),C=c.a.lazy((function(){return n.e(68).then(n.bind(null,120))})),M=c.a.lazy((function(){return n.e(65).then(n.bind(null,115))})),D=c.a.memo((function(e){var t=Object(r.useContext)(_.a),n=t.canvasAvailable,l=t.canvasToShown;return["share"].concat(Object(a.a)(n)).forEach((function(e){return document.getElementById("css_"+e).href="/rmg-test-page"+"/styles/".concat(e,"_gzmtr.css")})),c.a.createElement(c.a.Fragment,null,["runin","all"].includes(l)&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.CircularProgress,null)},c.a.createElement(A,null,c.a.createElement("svg",e.svgProps("runin"),e.children,c.a.createElement(C,null)))),["railmap","all"].includes(l)&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.CircularProgress,null)},c.a.createElement(A,null,c.a.createElement("svg",e.svgProps("railmap"),e.children,c.a.createElement(M,null)))))}),(function(){return!0})),R=c.a.lazy((function(){return n.e(49).then(n.bind(null,102))})),z=c.a.lazy((function(){return n.e(69).then(n.bind(null,103))})),B=c.a.lazy((function(){return n.e(67).then(n.bind(null,118))})),L=c.a.memo((function(e){var t=Object(r.useContext)(_.a),n=t.canvasAvailable,l=t.canvasToShown;return["share"].concat(Object(a.a)(n)).forEach((function(e){return document.getElementById("css_"+e).href="/rmg-test-page"+"/styles/".concat(e,"_shmetro.css")})),c.a.createElement(c.a.Fragment,null,["destination","all"].includes(l)&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.CircularProgress,null)},c.a.createElement(A,null,c.a.createElement("svg",e.svgProps("destination"),e.children,c.a.createElement(R,null)))),["runin","all"].includes(l)&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.CircularProgress,null)},c.a.createElement(A,null,c.a.createElement("svg",e.svgProps("runin"),e.children,c.a.createElement(z,null)))),["railmap","all"].includes(l)&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.CircularProgress,null)},c.a.createElement(A,null,c.a.createElement("svg",e.svgProps("railmap"),e.children,c.a.createElement(B,null)))))}),(function(){return!0})),G=Object(g.makeStyles)((function(){return Object(g.createStyles)({root:{display:"flex",flexDirection:"row",overflowX:"scroll","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}}})})),U=function(){var e=G(),t=c.a.useContext(_.b).param,n=c.a.useContext(_.a).canvasScale,a=function(e){var a;return{id:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:t.svg_height*n,viewBox:"0 0 ".concat(t.svgWidth[e]," ").concat(t.svg_height),style:(a={},Object(j.a)(a,"--rmg-svg-width",t.svgWidth[e]+"px"),Object(j.a)(a,"--rmg-svg-height",t.svg_height+"px"),Object(j.a)(a,"--rmg-theme-colour",t.theme[2]),Object(j.a)(a,"--rmg-theme-fg",t.theme[3]),a)}},r=c.a.createElement("rect",{x:0,y:0,fill:"white",stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}});return c.a.createElement("div",{className:e.root},c.a.createElement(y.d,null,c.a.createElement(y.b,{path:"/mtr"},c.a.createElement(k,{svgProps:a},r)),c.a.createElement(y.b,{path:"/gzmtr"},c.a.createElement(D,{svgProps:a},r)),c.a.createElement(y.b,{path:"/shmetro"},c.a.createElement(L,{svgProps:a},r)),c.a.createElement(y.a,{to:"/"+(new URLSearchParams(window.location.search).get("style")||"mtr")})))},H=r.lazy((function(){return n.e(58).then(n.bind(null,113))})),Z=r.lazy((function(){return n.e(55).then(n.bind(null,116))})),F=r.lazy((function(){return n.e(51).then(n.bind(null,117))})),W=r.lazy((function(){return n.e(60).then(n.bind(null,112))})),J=r.lazy((function(){return n.e(54).then(n.bind(null,104))})),Y=Object(g.makeStyles)((function(e){return Object(g.createStyles)({typography:{background:e.palette.background.default},tab:{padding:"6px 24px",height:48,minWidth:"calc(100% / 5)","& .MuiTab-wrapper":{flexDirection:"row"},"&.MuiTab-labelIcon":{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}},box:{display:"flex",justifyContent:"center",alignItems:"center"}})}));function X(e){var t=Object(o.useTranslation)(),n=t.t,a=t.i18n,c=Y(),l=r.useState(0),s=Object(f.a)(l,2),i=s[0],u=s[1],m=r.useMemo((function(){return r.createElement(g.Typography,{className:c.typography,component:"div"},r.createElement(g.Tabs,{value:i,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return u(t)},variant:"scrollable",scrollButtons:"off"},[["file","insert_drive_file"],["layout","panorama"],["design","brush"],["stations","directions_transit"],["info","info"]].map((function(e,t){return r.createElement(g.Tab,{label:r.createElement("span",null,n("tab."+e[0])),icon:r.createElement(g.Icon,null,e[1]),key:t,className:c.tab})})),"/>"))}),[i,a.language,c.tab]);return r.createElement(r.Fragment,null,m,r.createElement(g.Typography,{className:c.typography,component:"div",role:"tabpanel",style:{overflow:"auto"}},r.createElement(g.Box,{p:3,className:c.box},r.createElement(r.Suspense,{fallback:r.createElement(g.CircularProgress,null)},function(t){switch(t){case 0:return r.createElement(H,null);case 1:return r.createElement(Z,null);case 2:return r.createElement(F,null);case 3:return r.createElement(W,{theme:e.param.theme,stnList:e.param.stn_list,currentId:e.param.current_stn_idx,paramUpdate:e.paramUpdate,tpo:e.tpo});case 4:return r.createElement(J,null);default:return r.createElement(H,null)}}(i)))))}var K=function(e){return r.createElement(r.Suspense,{fallback:r.createElement(g.CircularProgress,null)},r.createElement(X,e))},V=n(15),Q=Object(g.createMuiTheme)({palette:{type:"dark",primary:{main:"#bb86fc"},secondary:{main:"#018786"},error:{main:"#cf6679"}},overrides:{MuiDialog:{paper:{minWidth:280}}}}),q=Object(g.createMuiTheme)({palette:{primary:{light:"#bb86fc",main:"#6200ee"},secondary:{main:"#018786"},error:{main:"#b00020"}},overrides:{MuiDialog:{paper:{minWidth:280}}}});function $(e){var t=Object(g.useMediaQuery)("(prefers-color-scheme: dark)")?Q:q,n=Object(r.useState)(e.canvas.includes(localStorage.rmgCanvas)?localStorage.rmgCanvas:"all"),a=Object(f.a)(n,2),l=a[0],s=a[1];Object(r.useEffect)((function(){return localStorage.setItem("rmgCanvas",l)}),[l]);var i=Object(r.useState)(Number(localStorage.rmgScale)>=.1?Number(localStorage.rmgScale):1),o=Object(f.a)(i,2),u=o[0],m=o[1];return Object(r.useEffect)((function(){return localStorage.setItem("rmgScale",u.toFixed(1))}),[u]),c.a.createElement(b.a,{basename:"/rmg-test-page"},c.a.createElement(g.ThemeProvider,{theme:t},c.a.createElement(_.a.Provider,{value:{rmgStyle:window.location.pathname.split("/")[2],canvasAvailable:e.canvas,canvasToShown:l,setCanvasToShown:s,canvasScale:u,setCanvasScale:m}},c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(g.LinearProgress,null)},c.a.createElement(v,null)),c.a.createElement(te,null))))}var ee,te=function(){var e=Object(r.useReducer)(_.c,JSON.parse(localStorage.rmgParam)),t=Object(f.a)(e,2),n=t[0],a=t[1],l=JSON.stringify(n);Object(r.useEffect)((function(){return localStorage.setItem("rmgParam",l)}),[l]);var s=Object.keys(n.stn_list).reduce((function(e,t){return e+t+function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){return t+JSON.stringify(e[n])}),"")}}("parents","children","branch")(n.stn_list[t])}),""),i=Object(r.useMemo)((function(){return Object(V.a)(n.stn_list)}),[s]),o=Object(r.useMemo)((function(){return Object(V.b)(n.stn_list)}),[s]),u=Object(V.d)(i);return c.a.createElement(c.a.Fragment,null,c.a.createElement(_.b.Provider,{value:{param:n,dispatch:a,branches:i,routes:o,deps:s}},c.a.createElement(U,null),c.a.createElement("div",{style:{flex:1,overflow:"auto",display:"flex",flexDirection:"column"}},c.a.createElement(K,{param:n,paramUpdate:function(e,t){return a({type:"ANY",key:e,data:t})},tpo:u}))),c.a.createElement("canvas",{style:{display:"none"}}))},ne=n(16);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}));var ae=function(e){switch(window.location.pathname.split("/")[2]){case"mtr":return["destination","railmap"];case"gzmtr":return["runin","railmap"];case"shmetro":return["destination","runin","railmap"];default:return["destination","railmap"]}}();(ee=document.head).append.apply(ee,Object(a.a)(["share","destination","runin","railmap"].map((function(e){var t=document.createElement("link");return t.rel="stylesheet",t.id="css_"+e,t}))));var re=function(){l.render(r.createElement($,{canvas:ae}),document.querySelectorAll("div#root")[0])};if(localStorage.rmgParam){try{Object(ne.c)()}catch(ce){alert(ce+"Something error! Please refresh to start from a new canvas. "),console.error(ce),localStorage.removeItem("rmgParam")}re()}else n.e(0).then(n.bind(null,72)).then((function(e){localStorage.setItem("rmgParam",JSON.stringify(e.default)),Object(ne.c)()})).then((function(){return re()}))}],[[33,70,71]]]);
//# sourceMappingURL=main.f5078a04.chunk.js.map
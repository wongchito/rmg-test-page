(this["webpackJsonprail-map-generator"]=this["webpackJsonprail-map-generator"]||[]).push([[51],{23:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l}));var r=n(9),a=n(3),c=n(0),s=c.createContext(null),i=c.createContext(null),l=function(e,t){var n,c,s,i,l,o;switch(t.type){case"GLOBAL":return t.data;case"ANY":return Object(a.a)({},e,Object(r.a)({},t.key,t.data));case"SET_HEIGHT":return Object(a.a)({},e,{svg_height:t.value});case"SET_WIDTH":return Object(a.a)({},e,{svgWidth:Object(a.a)({},e.svgWidth,Object(r.a)({},t.targetId,t.value))});case"SET_Y":return Object(a.a)({},e,{y_pc:t.value});case"SET_BRANCH_SPACING":return Object(a.a)({},e,{branch_spacing:t.value});case"SET_PADDING":return Object(a.a)({},e,{padding:t.value});case"SET_DIRECTION_GZ_X":return Object(a.a)({},e,{direction_gz_x:t.value});case"SET_DIRECTION_GZ_Y":return Object(a.a)({},e,{direction_gz_y:t.value});case"SET_LINE_NAME":return Object(a.a)({},e,{line_name:t.name});case"SET_THEME":return Object(a.a)({},e,{theme:t.theme});case"SET_DIRECTION":return Object(a.a)({},e,{direction:"l"===e.direction?"r":"l"});case"SET_PLATFORM":return Object(a.a)({},e,{platform_num:t.platform});case"SET_TEXT_FLIP":return Object(a.a)({},e,{txt_flip:!e.txt_flip});case"SET_DEST_LEGACY":return Object(a.a)({},e,{dest_legacy:t.isLegacy,customiseMTRDest:Object(a.a)({},e.customiseMTRDest,{isLegacy:t.isLegacy})});case"SET_TERMINAL_OVERRIDE":return Object(a.a)({},e,{customiseMTRDest:Object(a.a)({},e.customiseMTRDest,{terminal:t.terminal})});case"SET_LINE_NUM":return Object(a.a)({},e,{line_num:t.num});case"SET_PSD_NUM":return Object(a.a)({},e,{psd_num:t.num});case"SET_PANEL_TYPE":return Object(a.a)({},e,{info_panel_type:t.variant});case"ADD_NOTE_GZMTR":return Object(a.a)({},e,{notesGZMTR:null===(n=e.notesGZMTR)||void 0===n?void 0:n.concat([["","",0,0,!1]])});case"REMOVE_NOTE_GZMTR":return Object(a.a)({},e,{notesGZMTR:null===(c=e.notesGZMTR)||void 0===c?void 0:c.filter((function(e,n){return n!==t.idx}))});case"UPDATE_NOTE_GZMTR":return Object(a.a)({},e,{notesGZMTR:null===(s=e.notesGZMTR)||void 0===s?void 0:s.map((function(e,n){return n===t.idx?t.note:e}))});case"UPDATE_STATION_NAME":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{name:t.name})))});case"UPDATE_STATION_NUM":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{num:t.num})))});case"UPDATE_STATION_TRANSFER":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{transfer:t.transfer})))});case"UPDATE_STATION_INTERCHANGE_INFO":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{transfer:Object(a.a)({},e.stn_list[t.stnId].transfer,{info:null===(i=e.stn_list[t.stnId].transfer)||void 0===i?void 0:i.info.map((function(e,n){return n===t.setIdx?e.map((function(e,n){return n===t.intIdx?[0,1,2,3,4,5].map((function(n){return void 0===t.info[n]?e[n]:t.info[n]})):e})):e}))})})))});case"UPDATE_STATION_OSI_NAME":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{transfer:Object(a.a)({},e.stn_list[t.stnId].transfer,{osi_names:[t.name]})})))});case"UPDATE_STATION_TICK_DIREC":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{transfer:Object(a.a)({},e.stn_list[t.stnId].transfer,{tick_direc:t.direction})})))});case"UPDATE_STATION_PAID_AREA":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{transfer:Object(a.a)({},e.stn_list[t.stnId].transfer,{paid_area:t.isPaid})})))});case"UPDATE_STATION_BRANCH_TYPE":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{branch:Object(a.a)({},e.stn_list[t.stnId].branch,Object(r.a)({},t.direction,[t.branchType,e.stn_list[t.stnId].branch[t.direction][1]]))})))});case"UPDATE_STATION_BRANCH_FIRST":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,(l={},Object(r.a)(l,t.branches[0].stnId,Object(a.a)({},e.stn_list[t.branches[0].stnId],{branch:Object(a.a)({},e.stn_list[t.branches[0].stnId].branch,Object(r.a)({},t.branches[0].direction,[e.stn_list[t.branches[0].stnId].branch[t.branches[0].direction][0],t.branches[0].first]))})),Object(r.a)(l,t.branches[1].stnId,Object(a.a)({},e.stn_list[t.branches[1].stnId],{branch:Object(a.a)({},e.stn_list[t.branches[1].stnId].branch,Object(r.a)({},t.branches[1].direction,[e.stn_list[t.branches[1].stnId].branch[t.branches[1].direction][0],t.branches[1].first]))})),l))});case"UPDATE_STATION_BRANCH_POS":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,(o={},Object(r.a)(o,t.left,Object(a.a)({},e.stn_list[t.left],{parents:e.stn_list[t.left].parents.slice().reverse()})),Object(r.a)(o,t.right,Object(a.a)({},e.stn_list[t.right],{children:e.stn_list[t.right].children.slice().reverse()})),o))});case"UPDATE_STATION_FACILITY":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{facility:t.facility})))});case"UPDATE_STATION_SERVICES":return Object(a.a)({},e,{stn_list:Object(a.a)({},e.stn_list,Object(r.a)({},t.stnId,Object(a.a)({},e.stn_list[t.stnId],{services:Array.from(t.isChecked?new Set(e.stn_list[t.stnId].services).add(t.serviceId):e.stn_list[t.stnId].services.filter((function(e){return e!==t.serviceId})))})))});case"UPDATE_STATION_LIST":return Object(a.a)({},e,{stn_list:t.stnList});default:return e}}},43:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return l}));var r=n(13),a=n(0),c=function e(t,n){if(["linestart","lineend"].includes(t)||n[t].parents.length>1||n[t].children.length>1)return 0;var r=n[t].parents[0];return r?1==n[r].children.length?e(r,n):0==n[r].children.indexOf(t)?1:-1:0},s=function(e){console.log("computing branches");for(var t=["linestart"],n=[["linestart"]],r=0;t.length;){var a=t.shift(),c=n[r].slice().reverse()[0]||null;for(c&&"linestart"!==a?n[r].push(a):n[r]=[a];"lineend"!==a;){var s=e[c=a].children;switch(s.length){case 1:a=s[0];break;case 2:var i=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push([a]),t.push(i)):0===r&&(n.push([c]),t.push(i)),a=s.filter((function(e){return e!=i}))[0]}if(n[r].push(a),c===e[a].branch.left[1])break}r++}return n},i=function(e){console.log("computing routes");for(var t=["linestart"],n=[["linestart"]],r=0;t.length;){var a=t.shift(),c=n[r].slice().reverse()[0]||null;for(c&&"linestart"!==a?n[r].push(a):n[r]=[a];"lineend"!==a;){var s=e[c=a].children;switch(s.length){case 1:a=s[0];break;case 2:var i=e[c].branch.right[1];"through"===e[c].branch.right[0]?(n.push(n[r].slice()),t.push(i)):0===r&&(n.push([c]),t.push(i)),a=s.filter((function(e){return e!=i}))[0]}if(n[r].push(a),c===e[a].branch.left[1]&&"nonthrough"===e[a].branch.left[0])break}r++}return n},l=function(e){var t=a.useState([]),n=Object(r.a)(t,2),c=n[0],s=n[1];return a.useEffect((function(){if(console.log("computing tpo"),1!==e.length){var t=e.reduce((function(e,t){var n=e.indexOf(t.slice(-1)[0]);return e.slice(0,n).concat(t.slice(1),e.slice(n+1))}),["lineend"]).slice(0,-1);s(t)}else s(e[0].slice(1,-1))}),[e.toString()]),c}},54:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(13);function a(){var e=JSON.parse(localStorage.rmgParam);"line_name"in e||(e.line_name=["\u8def\u7dda\u540d","Name of Line"]),"dest_legacy"in e||(e.dest_legacy=!1),"char_form"in e||(e.char_form=function(e){switch(e){case"KR":return"trad";case"TC":return"tw";case"SC":return"cn";case"JP":return"jp"}}(e.fontZH[0].split(" ").reverse()[0])),delete e.fontZH,delete e.fontEN,delete e.weightZH,delete e.weightEN;for(var t=0,n=Object.entries(e.stn_list);t<n.length;t++){var a=Object(r.a)(n[t],2),c=a[0],s=a[1];"branch"in s||(e.stn_list[c].branch={left:[],right:[]},2==s.children.length?e.stn_list[c].branch.right=["through",s.children[1]]:e.stn_list[c].branch.right=[],2==s.parents.length?e.stn_list[c].branch.left=["through",s.parents[1]]:e.stn_list[c].branch.left=[])}"psd_num"in e||(e.psd_num=1),"line_num"in e||(e.line_num=1),delete e.style,3==e.theme.length&&e.theme.push("#fff");for(var i=0,l=Object.entries(e.stn_list);i<l.length;i++){var o=Object(r.a)(l[i],2),u=o[0],m=o[1];["linestart","lineend"].includes(u)||("num"in m||(e.stn_list[u].num="00"))}for(var h=0,f=Object.entries(e.stn_list);h<f.length;h++){var d=Object(r.a)(f[h],2),_=(d[0],d[1]);"interchange"in _&&_.interchange.map((function(e){e.map((function(e){5==e.length&&e.splice(3,0,"#fff")}))}))}"info_panel_type"in e||(e.info_panel_type="panasonic");for(var b=0,g=Object.entries(e.stn_list);b<g.length;b++){var p=Object(r.a)(g[b],2),O=p[0],v=p[1];"osi22_end_p"===v.change_type&&(e.stn_list[O].change_type="osi22_pr"),"osi22_end_u"===v.change_type&&(e.stn_list[O].change_type="osi22_ur")}for(var j=0,E=Object.entries(e.stn_list);j<E.length;j++){var y=Object(r.a)(E[j],2),T=y[0];"interchange"in y[1]||(e.stn_list[T].interchange=[[]])}"gz_1"===e.info_panel_type&&(e.info_panel_type="gz28"),"panasonic"===e.info_panel_type&&(e.info_panel_type="gz28"),"gz_2"===e.info_panel_type&&(e.info_panel_type="gzgf"),"gz_3"===e.info_panel_type&&(e.info_panel_type="gz3"),"direction_gz_x"in e||(e.direction_gz_x=50),"direction_gz_y"in e||(e.direction_gz_y=70);for(var I=0,S=Object.entries(e.stn_list);I<S.length;I++){var w=Object(r.a)(S[I],2),N=w[0],A=w[1];"transfer"in A||(e.stn_list[N].transfer={type:A.change_type.split("_")[0],tick_direc:"none"===A.change_type||"int2"===A.change_type?"r":A.change_type.split("_")[1].split("").slice().reverse()[0],paid_area:-1===A.change_type.indexOf("osi")||"p"===A.change_type.split("_")[1][0],osi_names:-1!==A.change_type.indexOf("osi")?[A.interchange[1][0]]:[],info:2===A.interchange.length?[A.interchange[0],A.interchange[1].slice(1)]:A.interchange})}for(var P=0,x=Object.entries(e.stn_list);P<x.length;P++){var k=Object(r.a)(x[P],2),C=k[0];"services"in k[1]||(e.stn_list[C].services=["local"])}for(var z=0,D=Object.entries(e.stn_list);z<D.length;z++){var M=Object(r.a)(D[z],2),R=M[0];"usage"in M[1]||(e.stn_list[R].usage="")}for(var G=0,L=Object.entries(e.stn_list);G<L.length;G++){var H=Object(r.a)(L[G],2),U=H[0],Z=H[1];"facility"in Z||(e.stn_list[U].facility=Z.usage)}"customiseMTRDest"in e||(e.customiseMTRDest={isLegacy:e.dest_legacy,terminal:!1}),"svgWidth"in e||(e.svgWidth={destination:e.svg_dest_width,runin:e.svg_dest_width,railmap:e.svg_width}),"notesGZMTR"in e||(e.notesGZMTR=[]),e.notesGZMTR=e.notesGZMTR.map((function(e){return 4===e.length?e.concat([!1]):e})),localStorage.setItem("rmgParam",JSON.stringify(e))}var c=function(e,t){return t.reduce((function(t,n){return t||(e[n]?e[n]:t)}),"")},s=function(e){return"".concat("gzmtr"===window.urlParams.get("style")?((null===e||void 0===e?void 0:e.num)||"-")+": ":"").concat(null===e||void 0===e?void 0:e.name.join().replace("\\"," "))}},81:function(e,t,n){e.exports=n(99)},86:function(e,t,n){},99:function(e,t,n){"use strict";n.r(t);var r=n(53),a=n(0),c=n(10),s=(n(86),n(56)),i=n(26),l=n(70),o=n(71);s.a.use(l.a).use(o.a).use(i.b).init({fallbackLng:{"zh-CN":["zh-Hans","en"],"zh-Hant":["zh-HK","en"],"zh-HK":["zh-Hant","en"],"zh-TW":["zh-HK","zh-Hant"],default:["en"]},debug:!0,backend:{loadPath:"rmg-test-page/locale/{{lng}}.json"},interpolation:{escapeValue:!1}}).then((function(e){document.title=e("title"),document.documentElement.setAttribute("lang",s.a.language)}));var u=n(13),m=n(123),h=n(143),f=n(125),d=n(126),_=n(127),b=n(128),g=n(144),p=n(131),O=n(132),v=n(108),j=n(134),E=n(135),y=n(23),T=Object(m.a)((function(e){return Object(h.a)({rootLight:{backgroundColor:e.palette.primary.main},rootDark:{backgroundColor:e.palette.background.paper},title:{flexGrow:1,color:"#fff"},menuButton:{color:"#fff"}})})),I=function(){var e=Object(i.c)(),t=e.t,n=e.i18n,r=T(),c=Object(f.a)("(prefers-color-scheme: dark)");return a.useMemo((function(){return a.createElement(d.a,{position:"sticky",className:c?r.rootDark:r.rootLight},a.createElement(_.a,{variant:"dense"},a.createElement(b.a,{variant:"h6",className:r.title,color:"textPrimary"},t("title")),a.createElement(S,null),a.createElement(w,null)))}),[c,n.language])},S=function(){var e=Object(i.c)().t,t=T(),n=a.useContext(y.a),r=n.canvasAvailable,c=n.setCanvasToShown,s=a.useState(null),l=Object(u.a)(s,2),o=l[0],m=l[1],h=function(e){return function(){c(e),m(null)}};return a.useMemo((function(){return a.createElement(a.Fragment,null,a.createElement(g.a,{title:e("toggle.tooltip")},a.createElement(p.a,{onClick:function(e){return m(e.currentTarget)},className:t.menuButton},a.createElement(O.a,null,"photo_library"))),a.createElement(v.a,{anchorEl:o,open:Boolean(o),onClose:function(){return m(null)}},r.map((function(t){return a.createElement(j.a,{key:t,onClick:h(t)},e("toggle."+t))})),a.createElement(E.a,{style:{margin:"6px 0"}}),a.createElement(j.a,{onClick:h("all")},e("toggle.all"))))}),[r.toString(),o,t.menuButton])},w=function(){var e=Object(i.c)().t,t=T(),n=a.useContext(y.a).setCanvasScale;return a.useMemo((function(){return a.createElement(a.Fragment,null,a.createElement(g.a,{title:e("zoom.out")},a.createElement(p.a,{onClick:function(){return n((function(e){return e<=.1?e:e-.1}))},className:t.menuButton},a.createElement(O.a,null,"zoom_out"))),a.createElement(g.a,{title:e("zoom.in")},a.createElement(p.a,{onClick:function(){return n((function(e){return e+.1}))},className:t.menuButton},a.createElement(O.a,null,"zoom_in"))))}),[t.menuButton])},N=n(9),A=function(e){switch(window.urlParams.get("style")){case"shmetro":return a.lazy((function(){return n.e(50).then(n.bind(null,247))}));default:return a.lazy((function(){return n.e(49).then(n.bind(null,248))}))}}(),P=function(e){return a.createElement("svg",e,e.children,a.createElement(A,null))},x=function(e){switch(window.urlParams.get("style")){case"shmetro":return a.lazy((function(){return n.e(70).then(n.bind(null,249))}));default:return a.lazy((function(){return n.e(69).then(n.bind(null,278))}))}}(),k=function(e){return a.createElement("svg",e,e.children,a.createElement(x,null))},C=function(e){switch(window.urlParams.get("style")){case"gzmtr":return a.lazy((function(){return n.e(66).then(n.bind(null,267))}));case"shmetro":return a.lazy((function(){return n.e(68).then(n.bind(null,272))}));default:return a.lazy((function(){return n.e(67).then(n.bind(null,268))}))}}(),z=function(e){return a.createElement("svg",e,e.children,a.createElement(C,null))},D=n(136),M=Object(m.a)((function(){return Object(h.a)({root:{display:"flex",flexDirection:"row",overflowX:"scroll","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}}})})),R=function(){var e=M(),t=a.useContext(y.b).param,n=a.useContext(y.a),r=n.canvasAvailable,c=n.canvasToShown,s=n.canvasScale,i=function(e){var n;return{id:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:t.svg_height*s,viewBox:"0 0 ".concat(t.svgWidth[e]," ").concat(t.svg_height),style:(n={},Object(N.a)(n,"--rmg-svg-width",t.svgWidth[e]+"px"),Object(N.a)(n,"--rmg-svg-height",t.svg_height+"px"),Object(N.a)(n,"--rmg-theme-colour",t.theme[2]),Object(N.a)(n,"--rmg-theme-fg",t.theme[3]),n),children:a.createElement("rect",{x:0,y:0,fill:"white",stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})}};return a.createElement("div",{className:e.root},r.map((function(e){return[e,"all"].includes(c)&&a.createElement(a.Suspense,{key:e,fallback:a.createElement(D.a,null)},function(e){switch(e){case"destination":return a.createElement(P,i(e));case"runin":return a.createElement(k,i(e));case"railmap":return a.createElement(z,i(e))}}(e))})))},G=n(141),L=n(137),H=n(140),U=a.lazy((function(){return Promise.all([n.e(2),n.e(73),n.e(59)]).then(n.bind(null,263))})),Z=a.lazy((function(){return Promise.all([n.e(1),n.e(48),n.e(56)]).then(n.bind(null,264))})),B=a.lazy((function(){return Promise.all([n.e(1),n.e(2),n.e(52)]).then(n.bind(null,270))})),W=a.lazy((function(){return Promise.all([n.e(1),n.e(2),n.e(74),n.e(61)]).then(n.bind(null,262))})),F=a.lazy((function(){return n.e(55).then(n.bind(null,265))})),J=Object(m.a)((function(e){return Object(h.a)({typography:{background:e.palette.background.default},tab:{padding:"6px 24px",height:48,minWidth:"calc(100% / 5)","& .MuiTab-wrapper":{flexDirection:"row"},"&.MuiTab-labelIcon":{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}},box:{display:"flex",justifyContent:"center",alignItems:"center"}})}));function Y(e){var t=Object(i.c)(),n=t.t,r=t.i18n,c=J(),s=a.useState(0),l=Object(u.a)(s,2),o=l[0],m=l[1],h=a.useMemo((function(){return a.createElement(b.a,{className:c.typography,component:"div"},a.createElement(G.a,{value:o,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return m(t)},variant:"scrollable",scrollButtons:"off"},[["file","insert_drive_file"],["layout","panorama"],["design","brush"],["stations","directions_transit"],["info","info"]].map((function(e,t){return a.createElement(L.a,{label:a.createElement("span",null,n("tab."+e[0])),icon:a.createElement(O.a,null,e[1]),key:t,className:c.tab})})),"/>"))}),[o,r.language,c.tab]);return a.createElement(a.Fragment,null,h,a.createElement(b.a,{className:c.typography,component:"div",role:"tabpanel",style:{overflow:"auto"}},a.createElement(H.a,{p:3,className:c.box},a.createElement(a.Suspense,{fallback:a.createElement(D.a,null)},function(t){switch(t){case 0:return a.createElement(U,null);case 1:return a.createElement(Z,null);case 2:return a.createElement(B,null);case 3:return a.createElement(W,{theme:e.param.theme,stnList:e.param.stn_list,currentId:e.param.current_stn_idx,paramUpdate:e.paramUpdate,tpo:e.tpo});case 4:return a.createElement(F,null);default:return a.createElement(U,null)}}(o)))))}var K=function(e){return a.createElement(a.Suspense,{fallback:a.createElement(D.a,null)},a.createElement(Y,e))},V=n(43),X=n(73),q=n(138),$=n(139),Q=Object(X.a)({palette:{type:"dark",primary:{main:"#bb86fc"},secondary:{main:"#018786"},error:{main:"#cf6679"}},overrides:{MuiDialog:{paper:{minWidth:280}}}}),ee=Object(X.a)({palette:{primary:{light:"#bb86fc",main:"#6200ee"},secondary:{main:"#018786"},error:{main:"#b00020"}},overrides:{MuiDialog:{paper:{minWidth:280}}}});function te(e){var t=Object(f.a)("(prefers-color-scheme: dark)")?Q:ee,n=a.useState(e.canvas.includes(localStorage.rmgCanvas)?localStorage.rmgCanvas:"all"),r=Object(u.a)(n,2),c=r[0],s=r[1];a.useEffect((function(){return localStorage.setItem("rmgCanvas",c)}),[c]);var i=a.useState(Number(localStorage.rmgScale)>=.1?Number(localStorage.rmgScale):1),l=Object(u.a)(i,2),o=l[0],m=l[1];return a.useEffect((function(){return localStorage.setItem("rmgScale",o.toFixed(1))}),[o]),a.createElement(a.Fragment,null,a.createElement(q.a,{theme:t},a.createElement(y.a.Provider,{value:{canvasAvailable:e.canvas,canvasToShown:c,setCanvasToShown:s,canvasScale:o,setCanvasScale:m}},a.createElement(a.Suspense,{fallback:a.createElement($.a,null)},a.createElement(I,null)),a.createElement(re,null))))}var ne,re=function(){var e=a.useReducer(y.c,JSON.parse(localStorage.rmgParam)),t=Object(u.a)(e,2),n=t[0],r=t[1],c=JSON.stringify(n);a.useEffect((function(){return localStorage.setItem("rmgParam",c)}),[c]);var s=Object.keys(n.stn_list).reduce((function(e,t){return e+t+function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){return t+JSON.stringify(e[n])}),"")}}("parents","children","branch")(n.stn_list[t])}),""),i=a.useMemo((function(){return Object(V.a)(n.stn_list)}),[s]),l=a.useMemo((function(){return Object(V.b)(n.stn_list)}),[s]),o=Object(V.d)(i);return a.createElement(a.Fragment,null,a.createElement(y.b.Provider,{value:{param:n,dispatch:r,branches:i,routes:l,deps:s}},a.createElement(R,null),a.createElement("div",{style:{flex:1,overflow:"auto",display:"flex",flexDirection:"column"}},a.createElement(K,{param:n,paramUpdate:function(e,t){return r({type:"ANY",key:e,data:t})},tpo:o}))),a.createElement("canvas",{style:{display:"none"}}))},ae=n(54);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));switch("serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),window.urlParams.get("style")){case"mtr":case"gzmtr":case"shmetro":break;default:window.urlParams.set("style","mtr")}window.history.pushState({url:window.location.href},"","?"+window.urlParams.toString());var ce=function(e){switch(window.urlParams.get("style")){case"mtr":return["destination","railmap"];case"gzmtr":return["runin","railmap"];case"shmetro":return["destination","runin","railmap"];default:return[]}}();(ne=document.head).append.apply(ne,Object(r.a)(["share"].concat(Object(r.a)(ce)).map((function(e){var t=document.createElement("link");return t.rel="stylesheet",t.href="rmg-test-page/styles/".concat(e,"_").concat(window.urlParams.get("style"),".css"),t.id="css_".concat(e),t}))));var se=function(){c.render(a.createElement(te,{canvas:ce}),document.querySelectorAll("div#root")[0])};if(localStorage.rmgParam){try{Object(ae.c)()}catch(ie){alert(ie+"Something error! Please refresh to start from a new canvas. "),console.error(ie),localStorage.removeItem("rmgParam")}se()}else n.e(0).then(n.bind(null,195)).then((function(e){localStorage.setItem("rmgParam",JSON.stringify(e.default)),Object(ae.c)()})).then((function(){return se()}))}},[[81,71,72]]]);
//# sourceMappingURL=main.b0725087.chunk.js.map